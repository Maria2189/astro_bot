{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Редактор Квиза</title>
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
  <script src="{% static 'js/jquery.min.js' %}"></script>
</head>
<body class="p-4">
  <h1>{{ form.instance.pk|yesno:"Редактировать квиз,Создать квиз" }}</h1>

  <form method="post">
    {% csrf_token %}
    <div class="mb-3">
      {{ form.title.label_tag }}
      {{ form.title }}
    </div>
    <div class="row mb-3">
      <div class="col">{{ form.topic.label_tag }}{{ form.topic }}</div>
      <div class="col">{{ form.level.label_tag }}{{ form.level }}</div>
    </div>

    <h2>Вопросы</h2>
    <div id="questions-container">
      {{ q_formset.management_form }}
      {% for q_form in q_formset.forms %}
        <div class="card mb-2 p-3 question-block" data-index="{{ forloop.counter0 }}">
          <h5>Вопрос {{ forloop.counter }}</h5>
          {{ q_form.id }}
          <div class="mb-2">{{ q_form.text.label_tag }}{{ q_form.text }}</div>
          <div class="mb-2">{{ q_form.explanation.label_tag }}{{ q_form.explanation }}</div>
          <div class="mb-2">{{ q_form.order.label_tag }}{{ q_form.order }}</div>
          <div class="mb-2">
            <button type="button" class="btn btn-sm btn-danger remove-question">Удалить вопрос</button>
          </div>
          <div class="choices-block">
            {{ choice_formsets.forloop.parentloop.counter0.management_form }}
            {% with choice_formset=choice_formsets.forloop.parentloop.counter0 %}
              {% for c_form in choice_formset.forms %}
                <div class="mb-2">
                  {{ c_form.text.label_tag }}{{ c_form.text }}
                  {{ c_form.is_correct.label_tag }}{{ c_form.is_correct }}
                  {{ c_form.order.label_tag }}{{ c_form.order }}
                </div>
              {% endfor %}
            {% endwith %}
          </div>
        </div>
      {% endfor %}
    </div>

    <button type="button" id="add-question" class="btn btn-primary">Добавить вопрос</button>
    <hr>
    <button type="submit" class="btn btn-success">Сохранить</button>
  </form>

  <script src="{% static 'js/quiz_editor.js' %}"></script>
</body>
</html>